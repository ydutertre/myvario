My Vario (Garmin ConnectIQ) App
===============================
Usage instructions


   !!! WARNING !!! DISCLAIMER !!! WARNING !!! DISCLAIMER !!! WARNING !!!

   THIS APPLICATION IS NOT TO BE USED AS A MEAN TO INSURE FLIGHT SAFETY.

  Always follow official or recommended procedures to insure flight safety,
         *independently* from the help this application can offer.

  In particular, this application relies on barometric pressure to derive
  the altitude and MUST NOT BE USED IN A PRESSURIZED AIRCRAFT.

  WARNING: This app is intended only as an in-flight aid and should not be
  used as a primary information source. This app contains a barometric
  altimeter, it will not function in a pressurized aircraft and should
  not be used in a pressurized aircraft.â€

   !!! WARNING !!! DISCLAIMER !!! WARNING !!! DISCLAIMER !!! WARNING !!!


Foreword
--------

My Vario relies on your device's raw barometric sensor to compute the altitude,
using the ad-hoc International Civil Aviation Organization (ICAO) formulas and
according to the International Standard Atmosphere (ISA).

Consequently, you MUST calibrate My Vario internal altimeter - using either
the known QNH or elevation (see Settings below) - to obtain an accurate
altitude reading (the device's "native" altimeter/barometer settings are
ignored).

My Vario is based on the excellent GliderSK by Cedric Dufour. If you like this
application, you should consider donating to him (see DONATE file).


General View
------------

The My Vario General view displays all the flight data in a single view, without
any further bells or whistles:
 - Top-Left:
   estimated wind direction (when available)
 - Top-Right:
   estimated wind speed (when available)
 - Left:
   your current altitude
 - Center:
   your current finesse
 - Right:
   your current (GPS) heading
 - Bottom-Left:
   your current vertical speed
 - Bottom-Right:
   your current ground speed

Variometer View
---------------

The My Vario Variometer displays your current ascent/descent rate both textu-
ally and graphically, using visually appealing colors:
 - GREEN for ascent
 - RED for descent


Varioplot / Thermal Assistant View
--------------

The My Vario Varioplot / Thermal Assistant graphically displays you ascent/descent
rate along your flight path, using visually appealing colors ranging from:
 - (Bright) GREEN for maximum ascent rate
 - (Bright) RED for maximum descent rate

Unless configured otherwise, the screen will automatically switch to this view
when circling is detected, and switch back to previous view once circling is no
longer detected.

In addition, the following values will be displayed in the corner of the plot:
 - Top-Left:
   your current altitude
 - Top-Right:
   your current vertical speed
 - Bottom-Left:
   your current ground speed
 - Bottom-Right:
   your current finesse

By pressing the MENU button (long-pressing the UP button), you will enter the
Pan/Zoom mode, where short pressing the following buttons will result in:
 - SELECT: switch between zoom in/out, pan up/down, pan left/right
 - UP:     zoom in  /OR/ pan up   /OR/ pan left
 - DOWN:   zoom out /OR/ pan down /OR/ pan right

By pressing the MENU button (long-pressing the UP button) a second time, you
will enter the Settings menu (see Settings below).

Log View
--------

My Vario Log view keeps track of your last recorded activities (global session
details; see Activity Recording below).

Use the SELECT and BACK buttons to browse through the last 100 saved entries.

The Log view is not available in flight (while recording)


Activity Recording
------------------

Controlling your activity recording status (start, pause, resume, save, discard)
is achieved by pressing the SELECT button. When recording, the BACK key will act
as Lap Key (unless configured not to do so; see Settings below).

My Vario adds custom fields to the recorded FIT file:
 - Barometric Altitude
 - Vertical Speed
(which will be plotted in Garmin Connect IF your installed the application
 through the Garmin ConnectIQ store)

For each lap and globally for the entire recording session, Garmin Connect will
also show the following details:
 - Distance: non-thermalling distance
 - Ascent: cumulative altitude gain and elapsed time spent ascending
 - Minimum Altitude: value and time
 - Maximum Altitude: value and time


Settings
--------

Unless explicitely stated otherwise for a given view, you may enter the Settings
menu by pressing the MENU button (long-pressing the UP button).

The application allows you to specify the following settings:

* Altimeter
  > Calibration
    - QNH:
      calibrate the altimeter using the current known QNH
    - Elevation:
      calibrate the altimeter using the current known elevation
      (QNH shall be adjusted accordingly)
  > Correction
    - Absolute:
      set the absolute device's sensor error correction
    - Relative:
      set the relative device's sensor error correction

* Variometer
  - Range:
    the range used for the variometer display and tones (3.0, 6.0 or 9.0 m/s)
  - Auto Thermal:
    whether the app will switch to Varioplot view automatically when circling is
    detected, and switch back once circling is no longer detected
  - Smoothing:
    the amount of smoothing to apply to the variometer reading (determines the standard
    deviation of altitude applied to the Kalman Filter: 0.2, 0.5, 0.7, or 1.0)
  - Plot Range:
    the time range (in minutes) for plotting the variometer-vs-location history

* Sounds
  - Variometer Tones:
    whether to play variometer tones
  - Vario Vibrations:
    whether to use variometer vibrations
  - Min. Climb:
    the minimum vertical speed required to play variometer tones and
    vibrations

* Activity
  - Auto Start
    whether to automatically start the activity recording
    throughout the flight (takeoff)
  - Start Speed
    speed above which the activity automatically starts/resumes
    (must be greater than the Stop Speed; ignored if set to zero)

* General
  - Background Color:
    the background color (black or white)
  - Lap Key:
    whether the BACK key adds a new lap to a recording activity

* Units
  - Distance:
    preferred units for displaying distance (and horizontal speed) values
  - Elevation:
    preferred units for displaying elevation (and vertical speed) values
  - Pressure:
    preferred units for displaying pressure
  - Direction:
    whether to show directions as an angle (247, 62, etc.) or as text (NW, SE, N, etc.)
  - Timezone:
    display Local Time (LT) or Universal Time Coordinates (UTC/Z)

* Storage
  - Clear logs:
    delete logs


About Data Filtering
--------------------

My Vario uses a Kalman Filter for Altitude and Vertical Speed. The filter
was derived from implementations in the SkyDrop vario and Arduino Open Vario.

Other values are not filtered.

The filter currently doesn't use data from the accelerometer, as gyroscope data 
is not yet available from the Garmin SDK. I am planning on adding this for System 5
devices, once SDK 4.1.0 comes out of Beta.

In general, filtered values are used.

Smoothing relies on the standard deviation of the Altitude (which depends on the
barometric sensor). This can be changed via the Variometer Smoothing setting.
Higher values of smoothing induce more lag - however, this seems to be less lag
for better results than the origina simple moving average of GliderSK.

However, the following exceptions apply:
- the Varioplot View always displays instantaneous data
- Activity Recorded (FIT) data are always instantaneous

Calibrating the Device Sensor
-----------------------------

My Vario allows you to calibrate/correct your device's barometric sensor using
the following formulas:

   QFEcalibrated = QFEsensor * Crel + Cabs

If you suspect your device's sensor is inaccurate, you shall:

1. install the PilotAltimeter widget to access the device's *QFE* readings
   (unfortunately, this falls out of My Vario scope/purpose)

2. take down multiple QFE readings, at different altitude, using your device's
   *raw* QFE and a reliable, calibrated, reference barometer

3. import those readings in a LibreOffice Calc (or Microsoft Excel) spreadsheet
   and obtain the Crel and Cabs coefficients by performing a linear regression:

     https://help.libreoffice.org/Calc/Regression_Analysis
     where Crel = Slope and Cabs = Intercept

   (curve-fitting for dummies: https://xkcd.com/2048/)

4. set Altimeter -> Correction -> Relative/Absolute values to the calculated
   cofficients

Not an easy feat. But if you must...


WARNING!!! GOTCHAS!!!
---------------------

When using GPS devices, you should be aware that:
 - GPS is very accurate for location (latitude/longitude) information;
   even more so when coupled with GLONASS (at the cost of battery usage).
 - (Garmin) UltraTrac feature is very cool to save battery but does NOT
   refresh location information frequently enough for My Vario purpose.

      !!! DO NOT USE ULTRATRAC WITH MY VARIO !!!

The ConnectIQ framework does NOT allow applications - like My Vario - to
control the location source (GPS, GLONASS and/or UltraTrac). The only way
to circumvent that limitation is to

      !!! USE A NATIVE GARMIN APPLICATION BEFOREHANDS !!!

The ConnectIQ application launched afterwards will then retain those settings.

